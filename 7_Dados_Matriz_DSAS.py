{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "77ed51a4-636f-4812-888b-07ba372f86dc",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Tabela de estatísticas por setor e intervalo:\n",
      "   Setor  Intervalo  Mínima (m)  Máxima (m)  Média (m)\n",
      "0      I  1984–1996     -575.53      994.38       9.31\n",
      "1      I  1996–2008    -1094.48      743.42     -42.07\n",
      "2      I  2008–2020    -1160.56      953.99      33.70\n",
      "3      I  2020–2024    -1197.01      125.14      -2.52\n",
      "4     II  1984–1996     -614.93      851.35      -2.38\n",
      "5     II  1996–2008    -1339.09      707.54      48.60\n",
      "6     II  2008–2020    -1649.42     1725.63      18.59\n",
      "7     II  2020–2024     -501.79     1433.98     -22.08\n",
      "8    III  1984–1996    -1123.63     1026.89      33.08\n",
      "9    III  1996–2008     -649.15      880.38       6.03\n",
      "10   III  2008–2020     -270.10      266.38      23.50\n",
      "11   III  2020–2024    -1177.32      327.88      26.75\n",
      "12    IV  1984–1996    -1484.34      772.75      90.47\n",
      "13    IV  1996–2008     -686.15      672.43      65.75\n",
      "14    IV  2008–2020    -1071.29      708.89      79.65\n",
      "15    IV  2020–2024      -98.54      931.78      57.05\n",
      "16     V  1984–1996     -668.29      611.44      77.47\n",
      "17     V  1996–2008    -1947.36      443.92      53.02\n",
      "18     V  2008–2020    -2289.17      514.07     -42.36\n",
      "19     V  2020–2024    -2458.53      641.37      40.41\n",
      "20    VI  1984–1996     -947.05     2586.03       9.03\n",
      "21    VI  1996–2008    -1198.01      886.71      14.64\n",
      "22    VI  2008–2020     -873.20      764.01      -9.90\n",
      "23    VI  2020–2024     -752.96     1167.80      47.39\n",
      "24   VII  1984–1996    -1314.56     1874.17      26.48\n",
      "25   VII  1996–2008    -1053.74     1283.85      14.94\n",
      "26   VII  2008–2020     -994.32      502.76       1.24\n",
      "27   VII  2020–2024    -1180.99      848.10      23.15\n",
      "\n",
      "Descrição por setor:\n",
      "\n",
      "Setor I:\n",
      "Entre 1984 e 1996, a linha costeira no Setor I apresentou variações entre -575.53 m e 994.38 m, com uma média de 9.31 m em direção ao mar. Entre 1996 e 2008, a linha costeira no Setor I apresentou variações entre -1094.48 m e 743.42 m, com uma média de -42.07 m em direção à terra. Entre 2008 e 2020, a linha costeira no Setor I apresentou variações entre -1160.56 m e 953.99 m, com uma média de 33.7 m em direção ao mar. Entre 2020 e 2024, a linha costeira no Setor I apresentou variações entre -1197.01 m e 125.14 m, com uma média de -2.52 m em direção à terra.\n",
      "\n",
      "Setor II:\n",
      "Entre 1984 e 1996, a linha costeira no Setor II apresentou variações entre -614.93 m e 851.35 m, com uma média de -2.38 m em direção à terra. Entre 1996 e 2008, a linha costeira no Setor II apresentou variações entre -1339.09 m e 707.54 m, com uma média de 48.6 m em direção ao mar. Entre 2008 e 2020, a linha costeira no Setor II apresentou variações entre -1649.42 m e 1725.63 m, com uma média de 18.59 m em direção ao mar. Entre 2020 e 2024, a linha costeira no Setor II apresentou variações entre -501.79 m e 1433.98 m, com uma média de -22.08 m em direção à terra.\n",
      "\n",
      "Setor III:\n",
      "Entre 1984 e 1996, a linha costeira no Setor III apresentou variações entre -1123.63 m e 1026.89 m, com uma média de 33.08 m em direção ao mar. Entre 1996 e 2008, a linha costeira no Setor III apresentou variações entre -649.15 m e 880.38 m, com uma média de 6.03 m em direção ao mar. Entre 2008 e 2020, a linha costeira no Setor III apresentou variações entre -270.1 m e 266.38 m, com uma média de 23.5 m em direção ao mar. Entre 2020 e 2024, a linha costeira no Setor III apresentou variações entre -1177.32 m e 327.88 m, com uma média de 26.75 m em direção ao mar.\n",
      "\n",
      "Setor IV:\n",
      "Entre 1984 e 1996, a linha costeira no Setor IV apresentou variações entre -1484.34 m e 772.75 m, com uma média de 90.47 m em direção ao mar. Entre 1996 e 2008, a linha costeira no Setor IV apresentou variações entre -686.15 m e 672.43 m, com uma média de 65.75 m em direção ao mar. Entre 2008 e 2020, a linha costeira no Setor IV apresentou variações entre -1071.29 m e 708.89 m, com uma média de 79.65 m em direção ao mar. Entre 2020 e 2024, a linha costeira no Setor IV apresentou variações entre -98.54 m e 931.78 m, com uma média de 57.05 m em direção ao mar.\n",
      "\n",
      "Setor V:\n",
      "Entre 1984 e 1996, a linha costeira no Setor V apresentou variações entre -668.29 m e 611.44 m, com uma média de 77.47 m em direção ao mar. Entre 1996 e 2008, a linha costeira no Setor V apresentou variações entre -1947.36 m e 443.92 m, com uma média de 53.02 m em direção ao mar. Entre 2008 e 2020, a linha costeira no Setor V apresentou variações entre -2289.17 m e 514.07 m, com uma média de -42.36 m em direção à terra. Entre 2020 e 2024, a linha costeira no Setor V apresentou variações entre -2458.53 m e 641.37 m, com uma média de 40.41 m em direção ao mar.\n",
      "\n",
      "Setor VI:\n",
      "Entre 1984 e 1996, a linha costeira no Setor VI apresentou variações entre -947.05 m e 2586.03 m, com uma média de 9.03 m em direção ao mar. Entre 1996 e 2008, a linha costeira no Setor VI apresentou variações entre -1198.01 m e 886.71 m, com uma média de 14.64 m em direção ao mar. Entre 2008 e 2020, a linha costeira no Setor VI apresentou variações entre -873.2 m e 764.01 m, com uma média de -9.9 m em direção à terra. Entre 2020 e 2024, a linha costeira no Setor VI apresentou variações entre -752.96 m e 1167.8 m, com uma média de 47.39 m em direção ao mar.\n",
      "\n",
      "Setor VII:\n",
      "Entre 1984 e 1996, a linha costeira no Setor VII apresentou variações entre -1314.56 m e 1874.17 m, com uma média de 26.48 m em direção ao mar. Entre 1996 e 2008, a linha costeira no Setor VII apresentou variações entre -1053.74 m e 1283.85 m, com uma média de 14.94 m em direção ao mar. Entre 2008 e 2020, a linha costeira no Setor VII apresentou variações entre -994.32 m e 502.76 m, com uma média de 1.24 m em direção ao mar. Entre 2020 e 2024, a linha costeira no Setor VII apresentou variações entre -1180.99 m e 848.1 m, com uma média de 23.15 m em direção ao mar.\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import os\n",
    "\n",
    "\n",
    "arquivo = r\"C:\\Users\\rafam\\Documents\\DSAS_ZC_ATLANTICO\\INTERSECT_POINT\\SETORES_I_VII_TransectID_atualizado.xlsx\"\n",
    "\n",
    "df = pd.read_excel(arquivo, sheet_name='setores')\n",
    "\n",
    "df['Ano'] = pd.to_datetime(df['ShorelineID'], errors='coerce').dt.year\n",
    "\n",
    "intervalos = [(1984, 1996), (1996, 2008), (2008, 2020), (2020, 2024)]\n",
    "\n",
    "resultados = []\n",
    "descricoes = {}\n",
    "\n",
    "for setor, grupo_setor in df.groupby('Setor'):\n",
    "    descricoes[setor] = []\n",
    "    for inicio, fim in intervalos:\n",
    "        dados_inicio = grupo_setor[grupo_setor['Ano'] == inicio]\n",
    "        dados_fim = grupo_setor[grupo_setor['Ano'] == fim]\n",
    "\n",
    "        dados_merged = pd.merge(\n",
    "            dados_inicio[['TransectID_atualiz', 'Distance']],\n",
    "            dados_fim[['TransectID_atualiz', 'Distance']],\n",
    "            on='TransectID_atualiz',\n",
    "            suffixes=('_inicio', '_fim')\n",
    "        )\n",
    "\n",
    "        dados_merged['Mudanca'] = dados_merged['Distance_fim'] - dados_merged['Distance_inicio']\n",
    "\n",
    "        if not dados_merged.empty:\n",
    "            min_mud = round(dados_merged['Mudanca'].min(), 2)\n",
    "            max_mud = round(dados_merged['Mudanca'].max(), 2)\n",
    "            mean_mud = round(dados_merged['Mudanca'].mean(), 2)\n",
    "\n",
    "            resultados.append({\n",
    "                'Setor': setor,\n",
    "                'Intervalo': f\"{inicio}–{fim}\",\n",
    "                'Mínima (m)': min_mud,\n",
    "                'Máxima (m)': max_mud,\n",
    "                'Média (m)': mean_mud\n",
    "            })\n",
    "\n",
    "            direcao = \"em direção à terra\" if mean_mud < 0 else \"em direção ao mar\"\n",
    "            texto = f\"Entre {inicio} e {fim}, a linha costeira no Setor {setor} apresentou variações entre {min_mud} m e {max_mud} m, com uma média de {mean_mud} m {direcao}.\"\n",
    "            descricoes[setor].append(texto)\n",
    "\n",
    "df_resultados = pd.DataFrame(resultados)\n",
    "\n",
    "pasta_saida = os.path.dirname(arquivo)\n",
    "arquivo_saida = os.path.join(pasta_saida, \"Dados_Matriz_DSAS.xlsx\")\n",
    "\n",
    "df_resultados.to_excel(arquivo_saida, index=False)\n",
    "\n",
    "print(\"Tabela de estatísticas por setor e intervalo:\")\n",
    "print(df_resultados)\n",
    "\n",
    "print(\"\\nDescrição por setor:\")\n",
    "for setor, textos in descricoes.items(): \n",
    "    print(f\"\\nSetor {setor}:\\n\" + \" \".join(textos))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e376964a-c20e-4284-924e-01bd19766bbb",
   "metadata": {},
   "outputs": [],
   "source": [
    "-"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:base] *",
   "language": "python",
   "name": "conda-base-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}